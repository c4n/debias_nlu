#!/bin/bash -l
#SBATCH --error=output/task.out.%j  # STDOUT output is written in slurm.out.JOBID
#SBATCH --output=output/task.out.%j # STDOUT error is written in slurm.err.JOBID
#SBATCH --job-name=test_allennlp       # Job name
#SBATCH --mem=16GB                  # Memory request for this job
#SBATCH --nodes=1                   # The number of nodes
#SBATCH --partition=gpu-cluster
#SBATCH --account=scads
#SBATCH --time=72:0:0                # Runing time 72 hours
#SBATCH --gpus=1                    # A number of GPUs  

 module load Anaconda3
 module load CUDA/10.1
 module load cuDNN/7
 module load HDF5

cd ~/CI4RRL_project
source ~/CI_env/bin/activate
allennlp predict outputs_hypo/model.tar.gz spurious_corr/MNLI/data/hypo_only_heuristics_evaluation_set.jsonl --output-file hypo_han_result.jsonl --batch-size 16 --cuda-device 0 --predictor textual_entailment 

